=== Log Session Started: 2025-10-07T13:16:54.912Z ===
Node Version: v23.7.0
Platform: darwin
Working Directory: /Users/nathanielstoddard/chainreact-app/chainreact-app-9e
================================================================================

[2025-10-07T13:16:54.913Z] [INFO   ] File logging initialized
[2025-10-07T13:16:54.913Z] [INFO   ] Log file: /Users/nathanielstoddard/chainreact-app/chainreact-app-9e/logs/workflow_2025-10-07_08-16-54.log
[2025-10-07T13:16:54.913Z] [INFO   ] 📁 File logging enabled
[2025-10-07T13:16:54.913Z] [INFO   ] 📝 Logs will be written to: /Users/nathanielstoddard/chainreact-app/chainreact-app-9e/logs/workflow_2025-10-07_08-16-54.log
[2025-10-07T13:16:54.913Z] [INFO   ] 💡 To view logs in real-time: tail -f /Users/nathanielstoddard/chainreact-app/chainreact-app-9e/logs/workflow_2025-10-07_08-16-54.log
[2025-10-07T13:16:54.913Z] [INFO   ] 💡 To view all logs: cat /Users/nathanielstoddard/chainreact-app/chainreact-app-9e/logs/workflow_2025-10-07_08-16-54.log
[2025-10-07T13:16:54.913Z] [INFO   ] 💡 To share logs: Copy the file at /Users/nathanielstoddard/chainreact-app/chainreact-app-9e/logs/workflow_2025-10-07_08-16-54.log
[2025-10-07T13:16:54.913Z] [INFO   ] --------------------------------------------------------------------------------
[2025-10-07T13:16:54.913Z] [INFO   ] 📁 File logging system initialized
[2025-10-07T13:16:54.925Z] [INFO   ]  [32m[1m✓[22m[39m Ready in 3.2s
[2025-10-07T13:16:55.972Z] [INFO   ] 🤖 Discord bot configured, initializing gateway connection in background...
[2025-10-07T13:16:57.428Z] [INFO   ] Initializing Discord Gateway connection (singleton)...
[2025-10-07T13:16:57.428Z] [INFO   ] 🔑 Using Discord bot token: MTM3ODU5NT...ElFqA
[2025-10-07T13:16:58.014Z] [INFO   ] Discord Gateway initialization complete
[2025-10-07T13:16:58.016Z] [INFO   ] ✅ Discord bot gateway connection initialized
[2025-10-07T13:16:58.204Z] [INFO   ] Discord Gateway WebSocket connection established
[2025-10-07T13:16:58.206Z] [INFO   ] 🔑 Sending identify with intents: {
  "GUILDS": true,
  "GUILD_MEMBERS": true,
  "GUILD_INVITES": true,
  "GUILD_MESSAGES": true,
  "MESSAGE_CONTENT": true,
  "intentsValue": 33347
}
[2025-10-07T13:16:58.369Z] [INFO   ] 🎉 Discord bot ready! {
  "sessionId": "34f170ef52c73f7eb5d92a6622c60061",
  "username": "ChainReact-Bot",
  "userId": "1378595955212812308",
  "guildCount": 2
}
[2025-10-07T13:16:58.369Z] [INFO   ] 📋 Initializing invite cache...
[2025-10-07T13:16:58.392Z] [INFO   ] 📡 Discord event received: GUILD_CREATE
[2025-10-07T13:16:58.494Z] [INFO   ] 📡 Discord event received: GUILD_CREATE
[2025-10-07T13:16:58.537Z] [INFO   ] ✅ Cached 4 invites for guild 1378950884045623406
[2025-10-07T13:17:03.262Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /middleware in 147ms (231 modules)
[2025-10-07T13:17:04.894Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11276337493,
  profileError: undefined
}
[2025-10-07T13:17:05.439Z] [INFO   ]  [37m[1m○[22m[39m Compiling /workflows/builder ...
[2025-10-07T13:17:08.827Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /workflows/builder in 3.9s (5574 modules)
[2025-10-07T13:17:09.590Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 743ms (1509 modules)
[2025-10-07T13:17:09.803Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T13:17:10.732Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/auth/profile ...
[2025-10-07T13:17:11.634Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/auth/profile in 1452ms (5578 modules)
[2025-10-07T13:17:12.761Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/collaboration/join ...
[2025-10-07T13:17:13.087Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/collaboration/join in 833ms (5585 modules)
[2025-10-07T13:17:13.166Z] [INFO   ] 📍 [API /api/integrations] GET request received {
  "timestamp": "2025-10-07T13:17:13.165Z",
  "headers": {
    "referer": "check-console"
  }
}
[2025-10-07T13:17:13.273Z] [INFO   ] ✅ [API /api/integrations] User authenticated {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0"
}
[2025-10-07T13:17:13.463Z] [INFO   ] 📊 [API /api/integrations] Query result {
  "count": 19,
  "error": null,
  "firstFew": [
    {
      "provider": "notion",
      "status": "connected"
    },
    {
      "provider": "google-sheets",
      "status": "connected"
    }
  ]
}
[2025-10-07T13:17:44.293Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/collaboration/collaborators in 390ms (5587 modules)
[2025-10-07T13:20:58.940Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/webhooks/gmail ...
[2025-10-07T13:21:02.220Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/webhooks/gmail in 3.8s (7589 modules)
[2025-10-07T13:21:04.553Z] [INFO   ] 🔔🔔🔔 GMAIL WEBHOOK ENDPOINT HIT! 🔔🔔🔔
[2025-10-07T13:21:04.554Z] [INFO   ] 📋 Request headers: {
  "accept": "application/json",
  "accept-encoding": "gzip, deflate, br",
  "content-length": "373",
  "content-type": "application/json",
  "from": "noreply@google.com",
  "host": "9b7007881520.ngrok-free.app",
  "user-agent": "APIs-Google; (+https://developers.google.com/webmasters/APIs-Google.html)",
  "x-forwarded-for": "142.250.32.34",
  "x-forwarded-host": "9b7007881520.ngrok-free.app",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "https"
}
[2025-10-07T13:21:04.555Z] [INFO   ] 📨 [626eb57b-9625-4a15-9577-5910c3044d6c] Gmail webhook request received at 2025-10-07T13:21:04.555Z
[2025-10-07T13:21:04.801Z] [INFO   ] 📝 [626eb57b-9625-4a15-9577-5910c3044d6c] Raw body received: {"deliveryAttempt":1,"message":{"data":"eyJlbWFpbEFkZHJlc3MiOiJzdG9kZGFyZC5uYXRoYW5pZWw5MDBAZ21haWwuY29tIiwiaGlzdG9yeUlkIjo2Nzc3MjI3fQ==","messageId":"16436319451367047","message_id":"16436319451367047","publishTime":"2025-10-07T13:20:57.469Z","publish_time":"2025-10-07T13:20:57.469Z"},"subscription":"projects/chainreact-462214/subscriptions/gmail-webhook-subscription"}

[2025-10-07T13:21:04.803Z] [INFO   ] 📦 [626eb57b-9625-4a15-9577-5910c3044d6c] Parsed body structure: {
  "hasMessage": true,
  "hasMessageData": true,
  "messageKeys": [
    "data",
    "messageId",
    "message_id",
    "publishTime",
    "publish_time"
  ],
  "subscription": "projects/chainreact-462214/subscriptions/gmail-webhook-subscription"
}
[2025-10-07T13:21:04.803Z] [INFO   ] [626eb57b-9625-4a15-9577-5910c3044d6c] Received Pub/Sub message from Gmail
[2025-10-07T13:21:04.803Z] [INFO   ] 🔓 [626eb57b-9625-4a15-9577-5910c3044d6c] Decoded Pub/Sub data: {"emailAddress":"stoddard.nathaniel900@gmail.com","historyId":6777227}
[2025-10-07T13:21:04.804Z] [INFO   ] [626eb57b-9625-4a15-9577-5910c3044d6c] 📧 Gmail notification received: {
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6777227,
  "messageId": "16436319451367047",
  "publishTime": "2025-10-07T13:20:57.469Z"
}
[2025-10-07T13:21:04.804Z] [INFO   ] [626eb57b-9625-4a15-9577-5910c3044d6c] 🔍 Processing Gmail webhook for email from: stoddard.nathaniel900@gmail.com
[2025-10-07T13:21:04.892Z] [INFO   ] 🔍 [Gmail Processor] Processing Gmail event: {
  "eventType": "gmail_new_email",
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6777227,
  "requestId": "626eb57b-9625-4a15-9577-5910c3044d6c"
}
[2025-10-07T13:21:04.893Z] [INFO   ] [Backend INFO] Gmail webhook event received {
  "eventType": "gmail_new_email",
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6777227,
  "requestId": "626eb57b-9625-4a15-9577-5910c3044d6c"
}
[2025-10-07T13:21:05.011Z] [INFO   ] 🚀 [Gmail Processor] Starting to find matching workflows for Gmail event
[2025-10-07T13:21:05.211Z] [INFO   ] Processing Gmail new message event
[2025-10-07T13:21:05.301Z] [INFO   ] [Task Queue] Queued gmail webhook task: undefined
[2025-10-07T13:21:05.303Z] [INFO   ] [Backend SUCCESS] Gmail webhook event processed successfully {
  "processed": true,
  "type": "gmail_new_message"
}
[2025-10-07T13:22:09.414Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11276642013,
  profileError: undefined
}
[2025-10-07T13:22:10.016Z] [INFO   ]  [37m[1m○[22m[39m Compiling /workflows ...
[2025-10-07T13:22:11.950Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /workflows in 2.4s (5735 modules)
[2025-10-07T13:22:12.584Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T13:22:13.636Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/auth/profile in 275ms (4166 modules)
[2025-10-07T13:22:14.158Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/presence/count in 220ms (4168 modules)
[2025-10-07T13:22:17.687Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/integrations ...
[2025-10-07T13:22:17.824Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/integrations in 643ms (4170 modules)
[2025-10-07T13:22:17.976Z] [INFO   ] 📍 [API /api/integrations] GET request received {
  "timestamp": "2025-10-07T13:22:17.976Z",
  "headers": {
    "referer": "check-console"
  }
}
[2025-10-07T13:22:18.109Z] [INFO   ] ✅ [API /api/integrations] User authenticated {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0"
}
[2025-10-07T13:22:18.271Z] [INFO   ] 📊 [API /api/integrations] Query result {
  "count": 19,
  "error": null,
  "firstFew": [
    {
      "provider": "notion",
      "status": "connected"
    },
    {
      "provider": "google-sheets",
      "status": "connected"
    }
  ]
}
[2025-10-07T13:23:11.103Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/ai/usage ...
[2025-10-07T13:23:11.108Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/ai/usage in 526ms (5741 modules)
[2025-10-07T13:26:07.713Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11276880312,
  profileError: undefined
}
[2025-10-07T13:26:08.418Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T13:26:08.834Z] [INFO   ] 📍 [API /api/integrations] GET request received {
  "timestamp": "2025-10-07T13:26:08.834Z",
  "headers": {
    "referer": "check-console"
  }
}
[2025-10-07T13:26:08.925Z] [INFO   ] ✅ [API /api/integrations] User authenticated {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0"
}
[2025-10-07T13:26:09.073Z] [INFO   ] 📊 [API /api/integrations] Query result {
  "count": 19,
  "error": null,
  "firstFew": [
    {
      "provider": "notion",
      "status": "connected"
    },
    {
      "provider": "google-sheets",
      "status": "connected"
    }
  ]
}
[2025-10-07T13:26:16.859Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11276889459,
  profileError: undefined
}
[2025-10-07T13:26:17.204Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T13:26:18.011Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/collaboration/join ...
[2025-10-07T13:26:19.122Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/collaboration/join in 1662ms (4173 modules)
[2025-10-07T13:26:22.333Z] [INFO   ] 📍 [API /api/integrations] GET request received {
  "timestamp": "2025-10-07T13:26:22.333Z",
  "headers": {
    "referer": "check-console"
  }
}
[2025-10-07T13:26:22.471Z] [INFO   ] ✅ [API /api/integrations] User authenticated {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0"
}
[2025-10-07T13:26:22.598Z] [INFO   ] 📊 [API /api/integrations] Query result {
  "count": 19,
  "error": null,
  "firstFew": [
    {
      "provider": "notion",
      "status": "connected"
    },
    {
      "provider": "google-sheets",
      "status": "connected"
    }
  ]
}
[2025-10-07T13:26:30.175Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/integrations/gmail/data ...
[2025-10-07T13:26:30.182Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/integrations/gmail/data in 695ms (5752 modules)
[2025-10-07T13:26:30.316Z] [INFO   ] 🔍 [Gmail Data API] Request: {
  "integrationId": "610e4069-9323-4f4c-a80a-a5e56b700c1f",
  "dataType": "gmail_labels",
  "options": {}
}
[2025-10-07T13:26:30.317Z] [INFO   ] 🔍 [Gmail Data API] Request: {
  "integrationId": "610e4069-9323-4f4c-a80a-a5e56b700c1f",
  "dataType": "gmail-enhanced-recipients",
  "options": {}
}
[2025-10-07T13:26:30.445Z] [INFO   ] 🚀 [Gmail Data API] Executing handler for: gmail_labels
[2025-10-07T13:26:30.449Z] [INFO   ] 🚀 [Gmail Data API] Executing handler for: gmail-enhanced-recipients
[2025-10-07T13:26:30.450Z] [INFO   ] 🚀 [Gmail API] Fetching fresh enhanced recipients
[2025-10-07T13:26:30.451Z] [INFO   ] 🔍 [Gmail API] Integration scopes: [
  "https://www.googleapis.com/auth/documents",
  "https://www.googleapis.com/auth/userinfo.profile",
  "openid",
  "https://www.googleapis.com/auth/contacts.readonly",
  "https://www.googleapis.com/auth/drive.readonly",
  "https://www.googleapis.com/auth/gmail.settings.sharing",
  "https://www.googleapis.com/auth/spreadsheets",
  "https://www.googleapis.com/auth/drive",
  "https://www.googleapis.com/auth/gmail.modify",
  "https://www.googleapis.com/auth/gmail.settings.basic",
  "https://www.googleapis.com/auth/calendar",
  "https://www.googleapis.com/auth/userinfo.email"
]
[2025-10-07T13:26:30.451Z] [INFO   ] 📇 [Gmail API] Attempting to fetch Google Contacts...
[2025-10-07T13:26:30.646Z] [INFO   ] ✅ [Gmail API] Found 4 contacts from Google Contacts
[2025-10-07T13:26:30.648Z] [INFO   ] 👥 [Gmail API] Contacts raw preview: [
  {
    "names": [
      "SGT Aguilar"
    ],
    "emails": []
  },
  {
    "names": [
      "Nathaniel Stoddard"
    ],
    "emails": []
  },
  {
    "names": [
      "Sponsee A1C Simona Gamble"
    ],
    "emails": []
  },
  {
    "names": [
      "Rob"
    ],
    "emails": []
  }
]
[2025-10-07T13:26:30.648Z] [INFO   ] 📬 [Gmail API] Contacts returned: []
[2025-10-07T13:26:30.648Z] [INFO   ] 📧 [Gmail API] Fetching recent email recipients from sent and received...
[2025-10-07T13:26:30.748Z] [INFO   ] ✅ [Gmail Data API] Handler completed in 301ms, returned 14 items
[2025-10-07T13:26:31.229Z] [INFO   ] 📧 [Gmail API] Processing 30 messages (sent + received)...
[2025-10-07T13:26:33.145Z] [INFO   ] ✅ [Gmail API] Found 9 unique recipients from sent and received emails
[2025-10-07T13:26:33.146Z] [INFO   ] ✅ [Gmail API] Returning 9 enhanced recipients (contacts: true)
[2025-10-07T13:26:33.146Z] [INFO   ] ✅ [Gmail Data API] Handler completed in 2696ms, returned 9 items
[2025-10-07T13:26:41.838Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/workflows/[id] ...
[2025-10-07T13:26:44.392Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/workflows/[id] in 3.1s (7929 modules)
[2025-10-07T13:26:45.158Z] [INFO   ] 📝 [Workflow API] Updating workflow with body: {
  "id": "415773a4-527a-418b-9e60-0228170310cf",
  "name": "trello test workflow2",
  "hasName": true,
  "nameType": "string",
  "bodyKeys": [
    "name",
    "description",
    "nodes",
    "connections"
  ],
  "nodesCount": 1,
  "connectionsCount": 0
}
[2025-10-07T13:26:45.341Z] [INFO   ] ✅ [Workflow API] Successfully updated workflow: 415773a4-527a-418b-9e60-0228170310cf
[2025-10-07T13:26:46.133Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/collaboration/leave ...
[2025-10-07T13:26:46.309Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/collaboration/leave in 803ms (7931 modules)
[2025-10-07T13:26:57.514Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/user/ai-api-keys ...
[2025-10-07T13:26:57.743Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/user/ai-api-keys in 797ms (7932 modules)
[2025-10-07T13:34:15.146Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/collaboration/join in 2.4s (5731 modules)
[2025-10-07T13:34:15.780Z] [INFO   ]  [32m[1m✓[22m[39m Compiled (5749 modules)
[2025-10-07T13:34:15.974Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11277368575,
  profileError: undefined
}
[2025-10-07T13:34:16.262Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T13:34:16.864Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/collaboration/leave in 247ms (4166 modules)
[2025-10-07T13:34:18.019Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 1053ms (5751 modules)
[2025-10-07T13:34:18.210Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11277370811,
  profileError: undefined
}
[2025-10-07T13:34:18.335Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T13:34:21.857Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 332ms (1585 modules)
[2025-10-07T13:34:22.090Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11277374691,
  profileError: undefined
}
[2025-10-07T13:34:22.164Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T13:34:27.060Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 1744ms (5751 modules)
[2025-10-07T13:34:27.310Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11277379911,
  profileError: undefined
}
[2025-10-07T13:34:27.434Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T13:34:49.826Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 668ms (5751 modules)
[2025-10-07T13:34:50.148Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11277402749,
  profileError: undefined
}
[2025-10-07T13:34:50.691Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /_not-found in 492ms (5742 modules)
[2025-10-07T13:34:51.008Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11277403609,
  profileError: undefined
}
[2025-10-07T13:34:51.458Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T13:34:53.205Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/auth/profile ...
[2025-10-07T13:34:53.544Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/auth/profile in 932ms (4170 modules)
[2025-10-07T13:34:54.089Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/presence/count in 253ms (4172 modules)
[2025-10-07T13:34:55.337Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 762ms (5761 modules)
[2025-10-07T13:34:55.568Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11277408169,
  profileError: undefined
}
[2025-10-07T13:34:55.731Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T13:34:56.290Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/integrations in 487ms (4174 modules)
[2025-10-07T13:34:56.566Z] [INFO   ] 📍 [API /api/integrations] GET request received {
  "timestamp": "2025-10-07T13:34:56.566Z",
  "headers": {
    "referer": "check-console"
  }
}
[2025-10-07T13:34:56.654Z] [INFO   ] ✅ [API /api/integrations] User authenticated {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0"
}
[2025-10-07T13:34:56.797Z] [INFO   ] 📊 [API /api/integrations] Query result {
  "count": 19,
  "error": null,
  "firstFew": [
    {
      "provider": "notion",
      "status": "connected"
    },
    {
      "provider": "google-sheets",
      "status": "connected"
    }
  ]
}
[2025-10-07T13:35:27.886Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/collaboration/collaborators ...
[2025-10-07T13:35:27.938Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/collaboration/collaborators in 689ms (4174 modules)
[2025-10-07T13:35:43.103Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 595ms (5763 modules)
[2025-10-07T13:35:43.376Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11277455976,
  profileError: undefined
}
[2025-10-07T13:35:43.556Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T13:35:43.954Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/collaboration/leave in 301ms (4176 modules)
[2025-10-07T13:35:49.968Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/webhooks/gmail ...
[2025-10-07T13:35:52.775Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/webhooks/gmail in 3.3s (7776 modules)
[2025-10-07T13:35:54.561Z] [INFO   ] 🔔🔔🔔 GMAIL WEBHOOK ENDPOINT HIT! 🔔🔔🔔
[2025-10-07T13:35:54.561Z] [INFO   ] 📋 Request headers: {
  "accept": "application/json",
  "accept-encoding": "gzip, deflate, br",
  "content-length": "373",
  "content-type": "application/json",
  "from": "noreply@google.com",
  "host": "9b7007881520.ngrok-free.app",
  "user-agent": "APIs-Google; (+https://developers.google.com/webmasters/APIs-Google.html)",
  "x-forwarded-for": "142.250.32.32",
  "x-forwarded-host": "9b7007881520.ngrok-free.app",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "https"
}
[2025-10-07T13:35:54.561Z] [INFO   ] 📨 [aecdee80-814a-424f-83eb-c84e2e332c89] Gmail webhook request received at 2025-10-07T13:35:54.561Z
[2025-10-07T13:35:54.718Z] [INFO   ] 📝 [aecdee80-814a-424f-83eb-c84e2e332c89] Raw body received: {"deliveryAttempt":1,"message":{"data":"eyJlbWFpbEFkZHJlc3MiOiJzdG9kZGFyZC5uYXRoYW5pZWw5MDBAZ21haWwuY29tIiwiaGlzdG9yeUlkIjo2Nzc3Mjk2fQ==","messageId":"16436440209966507","message_id":"16436440209966507","publishTime":"2025-10-07T13:35:48.676Z","publish_time":"2025-10-07T13:35:48.676Z"},"subscription":"projects/chainreact-462214/subscriptions/gmail-webhook-subscription"}

[2025-10-07T13:35:54.718Z] [INFO   ] 📦 [aecdee80-814a-424f-83eb-c84e2e332c89] Parsed body structure: {
  "hasMessage": true,
  "hasMessageData": true,
  "messageKeys": [
    "data",
    "messageId",
    "message_id",
    "publishTime",
    "publish_time"
  ],
  "subscription": "projects/chainreact-462214/subscriptions/gmail-webhook-subscription"
}
[2025-10-07T13:35:54.718Z] [INFO   ] [aecdee80-814a-424f-83eb-c84e2e332c89] Received Pub/Sub message from Gmail
[2025-10-07T13:35:54.718Z] [INFO   ] 🔓 [aecdee80-814a-424f-83eb-c84e2e332c89] Decoded Pub/Sub data: {"emailAddress":"stoddard.nathaniel900@gmail.com","historyId":6777296}
[2025-10-07T13:35:54.718Z] [INFO   ] [aecdee80-814a-424f-83eb-c84e2e332c89] 📧 Gmail notification received: {
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6777296,
  "messageId": "16436440209966507",
  "publishTime": "2025-10-07T13:35:48.676Z"
}
[2025-10-07T13:35:54.718Z] [INFO   ] [aecdee80-814a-424f-83eb-c84e2e332c89] 🔍 Processing Gmail webhook for email from: stoddard.nathaniel900@gmail.com
[2025-10-07T13:35:54.813Z] [INFO   ] 🔍 [Gmail Processor] Processing Gmail event: {
  "eventType": "gmail_new_email",
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6777296,
  "requestId": "aecdee80-814a-424f-83eb-c84e2e332c89"
}
[2025-10-07T13:35:54.813Z] [INFO   ] [Backend INFO] Gmail webhook event received {
  "eventType": "gmail_new_email",
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6777296,
  "requestId": "aecdee80-814a-424f-83eb-c84e2e332c89"
}
[2025-10-07T13:35:54.829Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11277467429,
  profileError: undefined
}
[2025-10-07T13:35:54.935Z] [INFO   ] 🚀 [Gmail Processor] Starting to find matching workflows for Gmail event
[2025-10-07T13:35:55.026Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T13:35:55.114Z] [INFO   ] Processing Gmail new message event
[2025-10-07T13:35:55.204Z] [INFO   ] [Task Queue] Queued gmail webhook task: undefined
[2025-10-07T13:35:55.204Z] [INFO   ] [Backend SUCCESS] Gmail webhook event processed successfully {
  "processed": true,
  "type": "gmail_new_message"
}
[2025-10-07T13:35:58.189Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 975ms (7767 modules)
[2025-10-07T13:35:58.488Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11277471089,
  profileError: undefined
}
[2025-10-07T13:35:58.705Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T13:36:28.382Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 1086ms (7765 modules)
[2025-10-07T13:36:28.643Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11277501243,
  profileError: undefined
}
[2025-10-07T13:36:28.828Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T13:39:54.722Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/presence/count ...
