=== Log Session Started: 2025-10-07T21:01:35.510Z ===
Node Version: v23.7.0
Platform: darwin
Working Directory: /Users/nathanielstoddard/chainreact-app/chainreact-app-9e
================================================================================

[2025-10-07T21:01:35.510Z] [INFO   ] File logging initialized
[2025-10-07T21:01:35.510Z] [INFO   ] Log file: /Users/nathanielstoddard/chainreact-app/chainreact-app-9e/logs/workflow_2025-10-07_16-01-35.log
[2025-10-07T21:01:35.511Z] [INFO   ] 📁 File logging enabled
[2025-10-07T21:01:35.511Z] [INFO   ] 📝 Logs will be written to: /Users/nathanielstoddard/chainreact-app/chainreact-app-9e/logs/workflow_2025-10-07_16-01-35.log
[2025-10-07T21:01:35.511Z] [INFO   ] 💡 To view logs in real-time: tail -f /Users/nathanielstoddard/chainreact-app/chainreact-app-9e/logs/workflow_2025-10-07_16-01-35.log
[2025-10-07T21:01:35.511Z] [INFO   ] 💡 To view all logs: cat /Users/nathanielstoddard/chainreact-app/chainreact-app-9e/logs/workflow_2025-10-07_16-01-35.log
[2025-10-07T21:01:35.511Z] [INFO   ] 💡 To share logs: Copy the file at /Users/nathanielstoddard/chainreact-app/chainreact-app-9e/logs/workflow_2025-10-07_16-01-35.log
[2025-10-07T21:01:35.511Z] [INFO   ] --------------------------------------------------------------------------------
[2025-10-07T21:01:35.511Z] [INFO   ] 📁 File logging system initialized
[2025-10-07T21:01:35.517Z] [INFO   ]  [32m[1m✓[22m[39m Ready in 3.4s
[2025-10-07T21:01:35.856Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /middleware in 121ms (231 modules)
[2025-10-07T21:01:36.836Z] [INFO   ] 🤖 Discord bot configured, initializing gateway connection in background...
[2025-10-07T21:01:38.496Z] [INFO   ] Initializing Discord Gateway connection (singleton)...
[2025-10-07T21:01:38.496Z] [INFO   ] 🔑 Using Discord bot token: MTM3ODU5NT...ElFqA
[2025-10-07T21:01:38.510Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11304211110,
  profileError: undefined
}
[2025-10-07T21:01:38.722Z] [INFO   ] Discord Gateway initialization complete
[2025-10-07T21:01:38.724Z] [INFO   ] ✅ Discord bot gateway connection initialized
[2025-10-07T21:01:38.922Z] [INFO   ] Discord Gateway WebSocket connection established
[2025-10-07T21:01:38.926Z] [INFO   ] 🔑 Sending identify with intents: {
  "GUILDS": true,
  "GUILD_MEMBERS": true,
  "GUILD_INVITES": true,
  "GUILD_MESSAGES": true,
  "MESSAGE_CONTENT": true,
  "intentsValue": 33347
}
[2025-10-07T21:01:39.086Z] [INFO   ]  [37m[1m○[22m[39m Compiling /workflows/builder ...
[2025-10-07T21:01:39.151Z] [INFO   ] 🎉 Discord bot ready! {
  "sessionId": "f3c4355ecd9852d3338dffc2f265af28",
  "username": "ChainReact-Bot",
  "userId": "1378595955212812308",
  "guildCount": 2
}
[2025-10-07T21:01:39.151Z] [INFO   ] 📋 Initializing invite cache...
[2025-10-07T21:01:39.156Z] [INFO   ] 📡 Discord event received: GUILD_CREATE
[2025-10-07T21:01:39.156Z] [INFO   ] 📡 Discord event received: GUILD_CREATE
[2025-10-07T21:01:39.378Z] [INFO   ] ✅ Cached 4 invites for guild 1378950884045623406
[2025-10-07T21:01:44.277Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /workflows/builder in 5.7s (5582 modules)
[2025-10-07T21:01:45.000Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 703ms (1513 modules)
[2025-10-07T21:01:45.155Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T21:01:46.979Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/auth/profile ...
[2025-10-07T21:01:47.002Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/auth/profile in 527ms (5586 modules)
[2025-10-07T21:01:50.805Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/integrations in 412ms (5588 modules)
[2025-10-07T21:01:50.971Z] [INFO   ] 📍 [API /api/integrations] GET request received {
  "timestamp": "2025-10-07T21:01:50.971Z",
  "headers": {
    "referer": "check-console"
  }
}
[2025-10-07T21:01:51.061Z] [INFO   ] ✅ [API /api/integrations] User authenticated {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0"
}
[2025-10-07T21:01:51.217Z] [INFO   ] 📊 [API /api/integrations] Query result {
  "count": 19,
  "error": null,
  "firstFew": [
    {
      "provider": "notion",
      "status": "connected"
    },
    {
      "provider": "microsoft-outlook",
      "status": "needs_reauthorization"
    }
  ]
}
[2025-10-07T21:02:08.187Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/webhooks/gmail ...
[2025-10-07T21:02:10.564Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/webhooks/gmail in 2.9s (7599 modules)
[2025-10-07T21:02:13.511Z] [INFO   ] 🔔🔔🔔 GMAIL WEBHOOK ENDPOINT HIT! 🔔🔔🔔
[2025-10-07T21:02:13.512Z] [INFO   ] 📋 Request headers: {
  "accept": "application/json",
  "accept-encoding": "gzip, deflate, br",
  "content-length": "373",
  "content-type": "application/json",
  "from": "noreply@google.com",
  "host": "9b7007881520.ngrok-free.app",
  "user-agent": "APIs-Google; (+https://developers.google.com/webmasters/APIs-Google.html)",
  "x-forwarded-for": "142.250.32.37",
  "x-forwarded-host": "9b7007881520.ngrok-free.app",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "https"
}
[2025-10-07T21:02:13.512Z] [INFO   ] 📨 [f85ea4df-1154-4e2e-b55e-29dbe43f99ce] Gmail webhook request received at 2025-10-07T21:02:13.512Z
[2025-10-07T21:02:13.643Z] [INFO   ] 📝 [f85ea4df-1154-4e2e-b55e-29dbe43f99ce] Raw body received: {"deliveryAttempt":1,"message":{"data":"eyJlbWFpbEFkZHJlc3MiOiJzdG9kZGFyZC5uYXRoYW5pZWw5MDBAZ21haWwuY29tIiwiaGlzdG9yeUlkIjo2Nzc3ODg3fQ==","messageId":"16440957901977534","message_id":"16440957901977534","publishTime":"2025-10-07T21:02:06.857Z","publish_time":"2025-10-07T21:02:06.857Z"},"subscription":"projects/chainreact-462214/subscriptions/gmail-webhook-subscription"}

[2025-10-07T21:02:13.643Z] [INFO   ] 📦 [f85ea4df-1154-4e2e-b55e-29dbe43f99ce] Parsed body structure: {
  "hasMessage": true,
  "hasMessageData": true,
  "messageKeys": [
    "data",
    "messageId",
    "message_id",
    "publishTime",
    "publish_time"
  ],
  "subscription": "projects/chainreact-462214/subscriptions/gmail-webhook-subscription"
}
[2025-10-07T21:02:13.644Z] [INFO   ] [f85ea4df-1154-4e2e-b55e-29dbe43f99ce] Received Pub/Sub message from Gmail
[2025-10-07T21:02:13.644Z] [INFO   ] 🔓 [f85ea4df-1154-4e2e-b55e-29dbe43f99ce] Decoded Pub/Sub data: {"emailAddress":"stoddard.nathaniel900@gmail.com","historyId":6777887}
[2025-10-07T21:02:13.644Z] [INFO   ] [f85ea4df-1154-4e2e-b55e-29dbe43f99ce] 📧 Gmail notification received: {
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6777887,
  "messageId": "16440957901977534",
  "publishTime": "2025-10-07T21:02:06.857Z"
}
[2025-10-07T21:02:13.644Z] [INFO   ] [f85ea4df-1154-4e2e-b55e-29dbe43f99ce] 🔍 Processing Gmail webhook for email from: stoddard.nathaniel900@gmail.com
[2025-10-07T21:02:13.750Z] [INFO   ] 🔍 [Gmail Processor] Processing Gmail event: {
  "eventType": "gmail_new_email",
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6777887,
  "requestId": "f85ea4df-1154-4e2e-b55e-29dbe43f99ce"
}
[2025-10-07T21:02:13.751Z] [INFO   ] [Backend INFO] Gmail webhook event received {
  "eventType": "gmail_new_email",
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6777887,
  "requestId": "f85ea4df-1154-4e2e-b55e-29dbe43f99ce"
}
[2025-10-07T21:02:13.843Z] [INFO   ] 🚀 [Gmail Processor] Starting to find matching workflows for Gmail event
[2025-10-07T21:02:14.021Z] [INFO   ] Processing Gmail new message event
[2025-10-07T21:02:14.178Z] [INFO   ] [Task Queue] Queued gmail webhook task: undefined
[2025-10-07T21:02:14.178Z] [INFO   ] [Backend SUCCESS] Gmail webhook event processed successfully {
  "processed": true,
  "type": "gmail_new_message"
}
[2025-10-07T21:02:52.028Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11304284627,
  profileError: undefined
}
[2025-10-07T21:02:52.689Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T21:02:53.450Z] [INFO   ] 📍 [API /api/integrations] GET request received {
  "timestamp": "2025-10-07T21:02:53.450Z",
  "headers": {
    "referer": "check-console"
  }
}
[2025-10-07T21:02:53.557Z] [INFO   ] ✅ [API /api/integrations] User authenticated {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0"
}
[2025-10-07T21:02:53.710Z] [INFO   ] 📊 [API /api/integrations] Query result {
  "count": 19,
  "error": null,
  "firstFew": [
    {
      "provider": "notion",
      "status": "connected"
    },
    {
      "provider": "microsoft-outlook",
      "status": "needs_reauthorization"
    }
  ]
}
[2025-10-07T21:02:54.030Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/presence/count ...
[2025-10-07T21:02:54.804Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/presence/count in 1280ms (7604 modules)
[2025-10-07T21:02:56.834Z] [INFO   ] 📍 [API /api/integrations] GET request received {
  "timestamp": "2025-10-07T21:02:56.833Z",
  "headers": {
    "referer": "check-console"
  }
}
[2025-10-07T21:02:56.963Z] [INFO   ] ✅ [API /api/integrations] User authenticated {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0"
}
[2025-10-07T21:02:57.083Z] [INFO   ] 📊 [API /api/integrations] Query result {
  "count": 19,
  "error": null,
  "firstFew": [
    {
      "provider": "notion",
      "status": "connected"
    },
    {
      "provider": "microsoft-outlook",
      "status": "needs_reauthorization"
    }
  ]
}
[2025-10-07T21:03:25.989Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/collaboration/collaborators ...
[2025-10-07T21:03:26.521Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/collaboration/collaborators in 1087ms (5595 modules)
[2025-10-07T21:03:44.611Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11304337212,
  profileError: undefined
}
[2025-10-07T21:03:45.251Z] [INFO   ]  [37m[1m○[22m[39m Compiling /workflows ...
[2025-10-07T21:03:46.271Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /workflows in 1532ms (5752 modules)
[2025-10-07T21:03:47.027Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T21:03:49.313Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/ai/usage ...
[2025-10-07T21:03:50.511Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/ai/usage in 1704ms (5754 modules)
[2025-10-07T21:03:50.592Z] [INFO   ] 📍 [API /api/integrations] GET request received {
  "timestamp": "2025-10-07T21:03:50.592Z",
  "headers": {
    "referer": "check-console"
  }
}
[2025-10-07T21:03:50.738Z] [INFO   ] ✅ [API /api/integrations] User authenticated {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0"
}
[2025-10-07T21:03:50.887Z] [INFO   ] 📊 [API /api/integrations] Query result {
  "count": 19,
  "error": null,
  "firstFew": [
    {
      "provider": "notion",
      "status": "connected"
    },
    {
      "provider": "microsoft-outlook",
      "status": "needs_reauthorization"
    }
  ]
}
[2025-10-07T21:03:51.458Z] [INFO   ] 📍 [API /api/integrations] GET request received {
  "timestamp": "2025-10-07T21:03:51.458Z",
  "headers": {
    "referer": "check-console"
  }
}
[2025-10-07T21:03:51.541Z] [INFO   ] ✅ [API /api/integrations] User authenticated {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0"
}
[2025-10-07T21:03:51.674Z] [INFO   ] 📊 [API /api/integrations] Query result {
  "count": 19,
  "error": null,
  "firstFew": [
    {
      "provider": "notion",
      "status": "connected"
    },
    {
      "provider": "microsoft-outlook",
      "status": "needs_reauthorization"
    }
  ]
}
[2025-10-07T21:03:55.748Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/workflows/[id] ...
[2025-10-07T21:03:56.888Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/workflows/[id] in 2s (7932 modules)
[2025-10-07T21:03:59.356Z] [INFO   ] 📝 Registered trigger provider: microsoft
[2025-10-07T21:03:59.357Z] [INFO   ] 📝 Registered trigger provider: microsoft-outlook
[2025-10-07T21:03:59.357Z] [INFO   ] 📝 Registered trigger provider: teams
[2025-10-07T21:03:59.357Z] [INFO   ] 📝 Registered trigger provider: microsoft-onenote
[2025-10-07T21:03:59.357Z] [INFO   ] 📝 Registered trigger provider: onedrive
[2025-10-07T21:03:59.357Z] [INFO   ] 📝 Registered trigger provider: airtable
[2025-10-07T21:03:59.357Z] [INFO   ] 📝 Registered trigger provider: discord
[2025-10-07T21:03:59.357Z] [INFO   ] 📝 Registered trigger provider: slack
[2025-10-07T21:03:59.357Z] [INFO   ] 📝 Registered trigger provider: gmail
[2025-10-07T21:03:59.357Z] [INFO   ] 📝 Registered trigger provider: google-calendar
[2025-10-07T21:03:59.357Z] [INFO   ] 📝 Registered trigger provider: google-drive
[2025-10-07T21:03:59.357Z] [INFO   ] 📝 Registered trigger provider: google-sheets
[2025-10-07T21:03:59.357Z] [INFO   ] 📝 Registered trigger provider: google-docs
[2025-10-07T21:03:59.357Z] [INFO   ] 📝 Registered trigger provider: stripe
[2025-10-07T21:03:59.357Z] [INFO   ] 📝 Registered trigger provider: shopify
[2025-10-07T21:03:59.358Z] [INFO   ] ✅ Trigger lifecycle providers registered: [
  "microsoft",
  "microsoft-outlook",
  "teams",
  "microsoft-onenote",
  "onedrive",
  "airtable",
  "discord",
  "slack",
  "gmail",
  "google-calendar",
  "google-drive",
  "google-sheets",
  "google-docs",
  "stripe",
  "shopify"
]
[2025-10-07T21:03:59.452Z] [INFO   ] 🗑️ Deleting 15 trigger resources for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.452Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.534Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.535Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.535Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.619Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.620Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.620Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.693Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.693Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.693Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.772Z] [INFO   ] ℹ️ No trigger resources found for workflow 415773a4-527a-418b-9e60-0228170310cf
[2025-10-07T21:03:59.773Z] [INFO   ] ♻️ Deleted lifecycle-managed triggers before deleting workflow {
  "workflowId": "415773a4-527a-418b-9e60-0228170310cf"
}
[2025-10-07T21:03:59.827Z] [INFO   ] 🔗 Unregistering all webhooks for workflow 415773a4-527a-418b-9e60-0228170310cf
[2025-10-07T21:03:59.836Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.836Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.836Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.910Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.910Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.910Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.915Z] [INFO   ] No webhooks found for this workflow
[2025-10-07T21:03:59.915Z] [INFO   ] ♻️ Unregistered legacy webhooks before deleting workflow {
  "workflowId": "415773a4-527a-418b-9e60-0228170310cf"
}
[2025-10-07T21:03:59.994Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.994Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:03:59.994Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.101Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.102Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.102Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.186Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.187Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.187Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.264Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.264Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.265Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.354Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.355Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.355Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.441Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.441Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.441Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.514Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.515Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.515Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.588Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.588Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.588Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.665Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.666Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.666Z] [INFO   ] 🛑 Deactivating Google API triggers for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.739Z] [INFO   ] ℹ️ No active Google API subscriptions for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.740Z] [INFO   ] ✅ Deleted trigger: gmail for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.740Z] [INFO   ] ♻️ Deleted lifecycle-managed triggers before deleting workflow {
  "workflowId": "44483b9a-b524-4177-929c-d4e98ae1d92e"
}
[2025-10-07T21:04:00.741Z] [INFO   ] 🔗 Unregistering all webhooks for workflow 44483b9a-b524-4177-929c-d4e98ae1d92e
[2025-10-07T21:04:00.819Z] [INFO   ] No webhooks found for this workflow
[2025-10-07T21:04:00.821Z] [INFO   ] ♻️ Unregistered legacy webhooks before deleting workflow {
  "workflowId": "44483b9a-b524-4177-929c-d4e98ae1d92e"
}
[2025-10-07T21:04:04.676Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/templates/predefined ...
[2025-10-07T21:04:05.428Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/templates/predefined in 1255ms (7933 modules)
[2025-10-07T21:05:00.790Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/templates/[id]/copy ...
[2025-10-07T21:05:01.073Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/templates/[id]/copy in 918ms (7925 modules)
[2025-10-07T21:05:01.741Z] [INFO   ] Raw template data keys: [
  "id",
  "name",
  "description",
  "workflow_json",
  "category",
  "tags",
  "created_by",
  "is_public",
  "created_at",
  "updated_at",
  "is_predefined",
  "integrations",
  "difficulty",
  "estimated_time",
  "nodes",
  "connections"
]
[2025-10-07T21:05:01.742Z] [INFO   ] Nodes type: object
[2025-10-07T21:05:01.742Z] [INFO   ] Is nodes parsed: true
[2025-10-07T21:05:01.743Z] [INFO   ] Template structure: {
  "rawNodesType": "object",
  "parsedNodesType": "object",
  "parsedNodesLength": 20,
  "parsedConnectionsLength": 19,
  "hasWorkflowJson": true,
  "workflowJsonNodesLength": 0
}
[2025-10-07T21:05:01.743Z] [INFO   ] Copying template: {
  "templateName": "Smart Email Triage - Sales & Support Router",
  "nodeCount": 20,
  "connectionCount": 19,
  "firstNode": {
    "id": "gmail-trigger-1",
    "type": "custom",
    "hasData": true,
    "dataType": "gmail_trigger_new_email",
    "title": "New Email Received"
  }
}
[2025-10-07T21:05:01.744Z] [INFO   ] Creating workflow with 20 nodes and 19 connections
[2025-10-07T21:05:01.744Z] [INFO   ] Filtered 0 placeholder nodes, 20 nodes remaining
[2025-10-07T21:05:01.744Z] [INFO   ] Template processing: {
  "totalNodes": 20,
  "totalConnections": 19,
  "chainNodes": 0,
  "aiAgentNodes": 0
}
[2025-10-07T21:05:01.858Z] [INFO   ] Successfully created workflow 8859a385-c89f-4578-9fb1-cace50ae70b9 from template
[2025-10-07T21:05:02.044Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11304414644,
  profileError: undefined
}
[2025-10-07T21:05:02.393Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T21:05:03.058Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/integrations in 422ms (6353 modules)
[2025-10-07T21:05:03.484Z] [INFO   ]  [32m[1m✓[22m[39m Compiled (6355 modules)
[2025-10-07T21:05:03.532Z] [INFO   ] 📍 [API /api/integrations] GET request received {
  "timestamp": "2025-10-07T21:05:03.531Z",
  "headers": {
    "referer": "check-console"
  }
}
[2025-10-07T21:05:03.664Z] [INFO   ] ✅ [API /api/integrations] User authenticated {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0"
}
[2025-10-07T21:05:03.779Z] [INFO   ] 📊 [API /api/integrations] Query result {
  "count": 19,
  "error": null,
  "firstFew": [
    {
      "provider": "notion",
      "status": "connected"
    },
    {
      "provider": "microsoft-outlook",
      "status": "needs_reauthorization"
    }
  ]
}
[2025-10-07T21:05:34.632Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/collaboration/collaborators ...
[2025-10-07T21:05:34.670Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/collaboration/collaborators in 538ms (4175 modules)
[2025-10-07T21:06:08.267Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 1118ms (5757 modules)
[2025-10-07T21:06:08.357Z] [WARN   ]  [33m[1m⚠[22m[39m Fast Refresh had to perform a full reload. Read more: https://nextjs.org/docs/messages/fast-refresh-reload
[2025-10-07T21:06:08.468Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11304481069,
  profileError: undefined
}
[2025-10-07T21:06:08.696Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T21:06:08.697Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11304481298,
  profileError: undefined
}
[2025-10-07T21:06:09.045Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T21:06:09.680Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/auth/profile in 383ms (4170 modules)
[2025-10-07T21:06:10.163Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/presence/count in 247ms (4172 modules)
[2025-10-07T21:06:10.830Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/collaboration/join in 305ms (4174 modules)
[2025-10-07T21:06:11.096Z] [INFO   ]  [32m[1m✓[22m[39m Compiled (4177 modules)
[2025-10-07T21:06:11.151Z] [INFO   ] 📍 [API /api/integrations] GET request received {
  "timestamp": "2025-10-07T21:06:11.151Z",
  "headers": {
    "referer": "check-console"
  }
}
[2025-10-07T21:06:11.234Z] [INFO   ] ✅ [API /api/integrations] User authenticated {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0"
}
[2025-10-07T21:06:11.343Z] [INFO   ] 📊 [API /api/integrations] Query result {
  "count": 19,
  "error": null,
  "firstFew": [
    {
      "provider": "notion",
      "status": "connected"
    },
    {
      "provider": "microsoft-outlook",
      "status": "needs_reauthorization"
    }
  ]
}
[2025-10-07T21:07:54.237Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/integrations/airtable/data ...
[2025-10-07T21:07:55.102Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/integrations/airtable/data in 1694ms (5763 modules)
[2025-10-07T21:07:55.383Z] [INFO   ] 🔍 [Airtable API] Processing request: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "dataType": "airtable_bases",
  "status": "connected",
  "hasToken": true
}
[2025-10-07T21:07:55.383Z] [INFO   ] 🔍 Airtable bases fetcher called with integration: {
  "id": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "provider": "airtable",
  "hasToken": true,
  "tokenLength": 334
}
[2025-10-07T21:07:55.383Z] [INFO   ] 🔍 Validating Airtable token...
[2025-10-07T21:07:55.383Z] [INFO   ] 🔍 Fetching Airtable bases from API...
[2025-10-07T21:07:55.464Z] [INFO   ] 🔍 [Airtable API] Processing request: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "dataType": "airtable_bases",
  "status": "connected",
  "hasToken": true
}
[2025-10-07T21:07:55.464Z] [INFO   ] 🔍 Airtable bases fetcher called with integration: {
  "id": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "provider": "airtable",
  "hasToken": true,
  "tokenLength": 334
}
[2025-10-07T21:07:55.464Z] [INFO   ] 🔍 Validating Airtable token...
[2025-10-07T21:07:55.464Z] [INFO   ] 🔍 Fetching Airtable bases from API...
[2025-10-07T21:07:56.776Z] [INFO   ] ✅ Airtable bases fetched successfully: 3 bases
[2025-10-07T21:07:56.777Z] [INFO   ] ✅ [Airtable API] Successfully processed airtable_bases: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "resultCount": 3
}
[2025-10-07T21:07:56.845Z] [INFO   ] ✅ Airtable bases fetched successfully: 3 bases
[2025-10-07T21:07:56.846Z] [INFO   ] ✅ [Airtable API] Successfully processed airtable_bases: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "resultCount": 3
}
[2025-10-07T21:08:00.837Z] [INFO   ] 🔍 [Airtable API] Processing request: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "dataType": "airtable_tables",
  "status": "connected",
  "hasToken": true
}
[2025-10-07T21:08:00.838Z] [INFO   ] 🔍 Airtable tables fetcher called with: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "baseId": "appk6lVvLcx0lRw6o",
  "hasToken": true
}
[2025-10-07T21:08:00.838Z] [INFO   ] 🔍 Validating Airtable token...
[2025-10-07T21:08:00.838Z] [INFO   ] 🔍 Fetching Airtable tables from API...
[2025-10-07T21:08:00.842Z] [INFO   ] 🔍 [Airtable API] Processing request: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "dataType": "airtable_tables",
  "status": "connected",
  "hasToken": true
}
[2025-10-07T21:08:00.843Z] [INFO   ] 🔍 Airtable tables fetcher called with: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "baseId": "appk6lVvLcx0lRw6o",
  "hasToken": true
}
[2025-10-07T21:08:00.843Z] [INFO   ] 🔍 Validating Airtable token...
[2025-10-07T21:08:00.843Z] [INFO   ] 🔍 Fetching Airtable tables from API...
[2025-10-07T21:08:03.576Z] [INFO   ] ✅ Airtable tables fetched successfully: 2 tables from base "appk6lVvLcx0lRw6o"
[2025-10-07T21:08:03.577Z] [INFO   ] 🔍 Available tables: [
  {
    "id": "tblpe4ddngBiAX6cO",
    "name": "Sales Lead"
  },
  {
    "id": "tblTCbO8fHDEpRO36",
    "name": "Support Tickets"
  }
]
[2025-10-07T21:08:03.578Z] [INFO   ] ✅ [Airtable API] Successfully processed airtable_tables: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "resultCount": 2
}
[2025-10-07T21:08:03.612Z] [INFO   ] ✅ Airtable tables fetched successfully: 2 tables from base "appk6lVvLcx0lRw6o"
[2025-10-07T21:08:03.612Z] [INFO   ] 🔍 Available tables: [
  {
    "id": "tblpe4ddngBiAX6cO",
    "name": "Sales Lead"
  },
  {
    "id": "tblTCbO8fHDEpRO36",
    "name": "Support Tickets"
  }
]
[2025-10-07T21:08:03.613Z] [INFO   ] ✅ [Airtable API] Successfully processed airtable_tables: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "resultCount": 2
}
[2025-10-07T21:08:10.038Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/integrations/airtable/metadata ...
[2025-10-07T21:08:10.540Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/integrations/airtable/metadata in 1130ms (5766 modules)
[2025-10-07T21:08:10.640Z] [INFO   ] Metadata API called with: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "baseId": "appk6lVvLcx0lRw6o",
  "tableName": "Sales Lead"
}
[2025-10-07T21:08:10.764Z] [INFO   ] Access token decrypted successfully
[2025-10-07T21:08:10.764Z] [INFO   ] Fetching metadata from Airtable: https://api.airtable.com/v0/meta/bases/appk6lVvLcx0lRw6o/tables
[2025-10-07T21:08:11.100Z] [INFO   ] Airtable metadata response received: {
  "hasData": true,
  "tableCount": 2,
  "baseId": "appk6lVvLcx0lRw6o",
  "requestedTable": "Sales Lead"
}
[2025-10-07T21:08:11.101Z] [INFO   ] Table fields found: [
  {
    "name": "Lead Name",
    "type": "singleLineText",
    "id": "fldhWLKirI0nCCAdz"
  },
  {
    "name": "Email",
    "type": "email",
    "id": "fldyrdiQFECuuN9Ku"
  },
  {
    "name": "Interest",
    "type": "multilineText",
    "id": "fldR6ya3s7HAJWtix"
  }
]
[2025-10-07T21:08:18.004Z] [INFO   ] 🔍 [Airtable API] Processing request: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "dataType": "airtable_tables",
  "status": "connected",
  "hasToken": true
}
[2025-10-07T21:08:18.005Z] [INFO   ] 🔍 Airtable tables fetcher called with: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "baseId": "appk6lVvLcx0lRw6o",
  "hasToken": true
}
[2025-10-07T21:08:18.005Z] [INFO   ] 🔍 Validating Airtable token...
[2025-10-07T21:08:18.005Z] [INFO   ] 🔍 Fetching Airtable tables from API...
[2025-10-07T21:08:18.025Z] [INFO   ] 🔍 [Airtable API] Processing request: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "dataType": "airtable_tables",
  "status": "connected",
  "hasToken": true
}
[2025-10-07T21:08:18.025Z] [INFO   ] 🔍 Airtable tables fetcher called with: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "baseId": "appk6lVvLcx0lRw6o",
  "hasToken": true
}
[2025-10-07T21:08:18.025Z] [INFO   ] 🔍 Validating Airtable token...
[2025-10-07T21:08:18.025Z] [INFO   ] 🔍 Fetching Airtable tables from API...
[2025-10-07T21:08:19.384Z] [INFO   ] ✅ Airtable tables fetched successfully: 2 tables from base "appk6lVvLcx0lRw6o"
[2025-10-07T21:08:19.385Z] [INFO   ] 🔍 Available tables: [
  {
    "id": "tblpe4ddngBiAX6cO",
    "name": "Sales Lead"
  },
  {
    "id": "tblTCbO8fHDEpRO36",
    "name": "Support Tickets"
  }
]
[2025-10-07T21:08:19.386Z] [INFO   ] ✅ [Airtable API] Successfully processed airtable_tables: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "resultCount": 2
}
[2025-10-07T21:08:19.403Z] [INFO   ] ✅ Airtable tables fetched successfully: 2 tables from base "appk6lVvLcx0lRw6o"
[2025-10-07T21:08:19.404Z] [INFO   ] 🔍 Available tables: [
  {
    "id": "tblpe4ddngBiAX6cO",
    "name": "Sales Lead"
  },
  {
    "id": "tblTCbO8fHDEpRO36",
    "name": "Support Tickets"
  }
]
[2025-10-07T21:08:19.404Z] [INFO   ] ✅ [Airtable API] Successfully processed airtable_tables: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "resultCount": 2
}
[2025-10-07T21:08:22.077Z] [INFO   ] Metadata API called with: {
  "integrationId": "122e7cb6-965d-4012-a810-bccb27a1caaf",
  "baseId": "appk6lVvLcx0lRw6o",
  "tableName": "Support Tickets"
}
[2025-10-07T21:08:22.196Z] [INFO   ] Access token decrypted successfully
[2025-10-07T21:08:22.196Z] [INFO   ] Fetching metadata from Airtable: https://api.airtable.com/v0/meta/bases/appk6lVvLcx0lRw6o/tables
[2025-10-07T21:08:22.362Z] [INFO   ] Airtable metadata response received: {
  "hasData": true,
  "tableCount": 2,
  "baseId": "appk6lVvLcx0lRw6o",
  "requestedTable": "Support Tickets"
}
[2025-10-07T21:08:22.362Z] [INFO   ] Table fields found: [
  {
    "name": "Ticket ID",
    "type": "singleLineText",
    "id": "fldNGvMzlfglqijqR"
  },
  {
    "name": "Customer",
    "type": "singleLineText",
    "id": "fld7c0fsd4IiSAsCv"
  },
  {
    "name": "Issue",
    "type": "multilineText",
    "id": "fldQJ6DiG7Yhk1ICA"
  }
]
[2025-10-07T21:11:20.279Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/presence/count ...
[2025-10-07T21:11:20.321Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/presence/count in 1367ms (4170 modules)
[2025-10-07T21:13:18.534Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/webhooks/gmail ...
[2025-10-07T21:13:22.984Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/webhooks/gmail in 5.1s (6179 modules)
[2025-10-07T21:13:25.377Z] [INFO   ] 🔔🔔🔔 GMAIL WEBHOOK ENDPOINT HIT! 🔔🔔🔔
[2025-10-07T21:13:25.378Z] [INFO   ] 📋 Request headers: {
  "accept": "application/json",
  "accept-encoding": "gzip, deflate, br",
  "content-length": "373",
  "content-type": "application/json",
  "from": "noreply@google.com",
  "host": "9b7007881520.ngrok-free.app",
  "user-agent": "APIs-Google; (+https://developers.google.com/webmasters/APIs-Google.html)",
  "x-forwarded-for": "142.250.32.40",
  "x-forwarded-host": "9b7007881520.ngrok-free.app",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "https"
}
[2025-10-07T21:13:25.378Z] [INFO   ] 📨 [75ea6d12-9ae0-4542-8fbb-ef511a212563] Gmail webhook request received at 2025-10-07T21:13:25.378Z
[2025-10-07T21:13:25.547Z] [INFO   ] 📝 [75ea6d12-9ae0-4542-8fbb-ef511a212563] Raw body received: {"deliveryAttempt":1,"message":{"data":"eyJlbWFpbEFkZHJlc3MiOiJzdG9kZGFyZC5uYXRoYW5pZWw5MDBAZ21haWwuY29tIiwiaGlzdG9yeUlkIjo2Nzc3OTQ2fQ==","messageId":"16439787727951561","message_id":"16439787727951561","publishTime":"2025-10-07T21:13:17.082Z","publish_time":"2025-10-07T21:13:17.082Z"},"subscription":"projects/chainreact-462214/subscriptions/gmail-webhook-subscription"}

[2025-10-07T21:13:25.547Z] [INFO   ] 📦 [75ea6d12-9ae0-4542-8fbb-ef511a212563] Parsed body structure: {
  "hasMessage": true,
  "hasMessageData": true,
  "messageKeys": [
    "data",
    "messageId",
    "message_id",
    "publishTime",
    "publish_time"
  ],
  "subscription": "projects/chainreact-462214/subscriptions/gmail-webhook-subscription"
}
[2025-10-07T21:13:25.547Z] [INFO   ] [75ea6d12-9ae0-4542-8fbb-ef511a212563] Received Pub/Sub message from Gmail
[2025-10-07T21:13:25.547Z] [INFO   ] 🔓 [75ea6d12-9ae0-4542-8fbb-ef511a212563] Decoded Pub/Sub data: {"emailAddress":"stoddard.nathaniel900@gmail.com","historyId":6777946}
[2025-10-07T21:13:25.547Z] [INFO   ] [75ea6d12-9ae0-4542-8fbb-ef511a212563] 📧 Gmail notification received: {
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6777946,
  "messageId": "16439787727951561",
  "publishTime": "2025-10-07T21:13:17.082Z"
}
[2025-10-07T21:13:25.547Z] [INFO   ] [75ea6d12-9ae0-4542-8fbb-ef511a212563] 🔍 Processing Gmail webhook for email from: stoddard.nathaniel900@gmail.com
[2025-10-07T21:13:25.637Z] [INFO   ] 🔍 [Gmail Processor] Processing Gmail event: {
  "eventType": "gmail_new_email",
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6777946,
  "requestId": "75ea6d12-9ae0-4542-8fbb-ef511a212563"
}
[2025-10-07T21:13:25.638Z] [INFO   ] [Backend INFO] Gmail webhook event received {
  "eventType": "gmail_new_email",
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6777946,
  "requestId": "75ea6d12-9ae0-4542-8fbb-ef511a212563"
}
[2025-10-07T21:13:25.743Z] [INFO   ] 🚀 [Gmail Processor] Starting to find matching workflows for Gmail event
[2025-10-07T21:13:25.958Z] [INFO   ] Processing Gmail new message event
[2025-10-07T21:13:26.052Z] [INFO   ] [Task Queue] Queued gmail webhook task: undefined
[2025-10-07T21:13:26.052Z] [INFO   ] [Backend SUCCESS] Gmail webhook event processed successfully {
  "processed": true,
  "type": "gmail_new_message"
}
[2025-10-07T21:15:02.138Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/collaboration/leave ...
[2025-10-07T21:15:03.760Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/collaboration/leave in 2.6s (5741 modules)
[2025-10-07T21:15:04.033Z] [WARN   ]  [33m[1m⚠[22m[39m Fast Refresh had to perform a full reload due to a runtime error.
[2025-10-07T21:15:04.472Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11305017073,
  profileError: undefined
}
[2025-10-07T21:15:05.034Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T21:15:06.528Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/auth/profile ...
[2025-10-07T21:15:06.781Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/auth/profile in 811ms (4170 modules)
[2025-10-07T21:15:07.340Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/presence/count in 237ms (4172 modules)
[2025-10-07T21:15:10.850Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/integrations in 403ms (4174 modules)
[2025-10-07T21:15:10.949Z] [INFO   ] 📍 [API /api/integrations] GET request received {
  "timestamp": "2025-10-07T21:15:10.949Z",
  "headers": {
    "referer": "check-console"
  }
}
[2025-10-07T21:15:11.070Z] [INFO   ] ✅ [API /api/integrations] User authenticated {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0"
}
[2025-10-07T21:15:11.211Z] [INFO   ] 📊 [API /api/integrations] Query result {
  "count": 19,
  "error": null,
  "firstFew": [
    {
      "provider": "notion",
      "status": "connected"
    },
    {
      "provider": "microsoft-outlook",
      "status": "needs_reauthorization"
    }
  ]
}
[2025-10-07T21:18:11.545Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 2.6s (5739 modules)
[2025-10-07T21:18:11.950Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11305204551,
  profileError: undefined
}
[2025-10-07T21:18:12.172Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T21:18:12.707Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/collaboration/join in 301ms (4168 modules)
[2025-10-07T21:18:16.529Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 509ms (5757 modules)
[2025-10-07T21:18:16.783Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11305209384,
  profileError: undefined
}
[2025-10-07T21:18:16.951Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T21:18:17.349Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/collaboration/leave in 318ms (4170 modules)
[2025-10-07T21:18:26.040Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 526ms (5759 modules)
[2025-10-07T21:18:26.252Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11305218853,
  profileError: undefined
}
[2025-10-07T21:18:26.423Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T21:18:33.188Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 896ms (5759 modules)
[2025-10-07T21:18:33.407Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11305226008,
  profileError: undefined
}
[2025-10-07T21:18:33.586Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T21:18:47.641Z] [INFO   ]  [32m[1m✓[22m[39m Compiled in 835ms (5761 modules)
[2025-10-07T21:18:47.863Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11305240464,
  profileError: undefined
}
[2025-10-07T21:18:48.021Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T21:18:58.878Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/webhooks/gmail ...
[2025-10-07T21:19:02.242Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/webhooks/gmail in 3.9s (7773 modules)
[2025-10-07T21:19:04.693Z] [INFO   ] 🔔🔔🔔 GMAIL WEBHOOK ENDPOINT HIT! 🔔🔔🔔
[2025-10-07T21:19:04.693Z] [INFO   ] 📋 Request headers: {
  "accept": "application/json",
  "accept-encoding": "gzip, deflate, br",
  "content-length": "373",
  "content-type": "application/json",
  "from": "noreply@google.com",
  "host": "9b7007881520.ngrok-free.app",
  "user-agent": "APIs-Google; (+https://developers.google.com/webmasters/APIs-Google.html)",
  "x-forwarded-for": "142.250.32.37",
  "x-forwarded-host": "9b7007881520.ngrok-free.app",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "https"
}
[2025-10-07T21:19:04.693Z] [INFO   ] 📨 [bbb80be1-5479-4e1c-9ca4-9a36f8491dd8] Gmail webhook request received at 2025-10-07T21:19:04.693Z
[2025-10-07T21:19:04.813Z] [INFO   ] 📝 [bbb80be1-5479-4e1c-9ca4-9a36f8491dd8] Raw body received: {"deliveryAttempt":1,"message":{"data":"eyJlbWFpbEFkZHJlc3MiOiJzdG9kZGFyZC5uYXRoYW5pZWw5MDBAZ21haWwuY29tIiwiaGlzdG9yeUlkIjo2Nzc4MDA0fQ==","messageId":"16439732340690515","message_id":"16439732340690515","publishTime":"2025-10-07T21:18:57.086Z","publish_time":"2025-10-07T21:18:57.086Z"},"subscription":"projects/chainreact-462214/subscriptions/gmail-webhook-subscription"}

[2025-10-07T21:19:04.813Z] [INFO   ] 📦 [bbb80be1-5479-4e1c-9ca4-9a36f8491dd8] Parsed body structure: {
  "hasMessage": true,
  "hasMessageData": true,
  "messageKeys": [
    "data",
    "messageId",
    "message_id",
    "publishTime",
    "publish_time"
  ],
  "subscription": "projects/chainreact-462214/subscriptions/gmail-webhook-subscription"
}
[2025-10-07T21:19:04.813Z] [INFO   ] [bbb80be1-5479-4e1c-9ca4-9a36f8491dd8] Received Pub/Sub message from Gmail
[2025-10-07T21:19:04.813Z] [INFO   ] 🔓 [bbb80be1-5479-4e1c-9ca4-9a36f8491dd8] Decoded Pub/Sub data: {"emailAddress":"stoddard.nathaniel900@gmail.com","historyId":6778004}
[2025-10-07T21:19:04.814Z] [INFO   ] [bbb80be1-5479-4e1c-9ca4-9a36f8491dd8] 📧 Gmail notification received: {
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6778004,
  "messageId": "16439732340690515",
  "publishTime": "2025-10-07T21:18:57.086Z"
}
[2025-10-07T21:19:04.814Z] [INFO   ] [bbb80be1-5479-4e1c-9ca4-9a36f8491dd8] 🔍 Processing Gmail webhook for email from: stoddard.nathaniel900@gmail.com
[2025-10-07T21:19:04.903Z] [INFO   ] 🔍 [Gmail Processor] Processing Gmail event: {
  "eventType": "gmail_new_email",
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6778004,
  "requestId": "bbb80be1-5479-4e1c-9ca4-9a36f8491dd8"
}
[2025-10-07T21:19:04.904Z] [INFO   ] [Backend INFO] Gmail webhook event received {
  "eventType": "gmail_new_email",
  "emailAddress": "stoddard.nathaniel900@gmail.com",
  "historyId": 6778004,
  "requestId": "bbb80be1-5479-4e1c-9ca4-9a36f8491dd8"
}
[2025-10-07T21:19:04.959Z] [INFO   ] [Middleware] Username check: {
  path: '/workflows/builder',
  userId: 'a3e3a51a-175c-4b59-ad03-227ba12a18b0',
  provider: 'email',
  role: 'admin',
  username: 'nstoddard17',
  hasUsername: true,
  isBetaTester: false,
  isNewBetaUser: false,
  accountAge: 11305257559,
  profileError: undefined
}
[2025-10-07T21:19:05.001Z] [INFO   ] 🚀 [Gmail Processor] Starting to find matching workflows for Gmail event
[2025-10-07T21:19:05.119Z] [INFO   ] [Username Check] {
  "userId": "a3e3a51a-175c-4b59-ad03-227ba12a18b0",
  "email": "stoddard.nathaniel900@gmail.com",
  "provider": "email",
  "username": "nstoddard17",
  "hasUsername": true,
  "isGoogleUser": false
}
[2025-10-07T21:19:05.192Z] [INFO   ] Processing Gmail new message event
[2025-10-07T21:19:05.293Z] [INFO   ] [Task Queue] Queued gmail webhook task: undefined
[2025-10-07T21:19:05.293Z] [INFO   ] [Backend SUCCESS] Gmail webhook event processed successfully {
  "processed": true,
  "type": "gmail_new_message"
}
[2025-10-07T21:20:07.948Z] [INFO   ]  [37m[1m○[22m[39m Compiling /api/presence/count ...
[2025-10-07T21:20:09.413Z] [INFO   ]  [32m[1m✓[22m[39m Compiled /api/presence/count in 1965ms (6182 modules)

=== Log Session Ended: 2025-10-07T21:21:49.521Z ===
